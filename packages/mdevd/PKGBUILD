#!/bin/bash
# shellcheck disable=SC2034,SC2154,SC2068
# Maintainer: Jeremy Huntwork <jeremy@merelinux.org>

pkgname=(mdevd)
pkgver=0.1.4.0
pkgrel=1
pkgdesc='A small daemon managing kernel hotplug events, similarly to udevd.'
arch=(x86_64)
url='http://skarnet.org/software/mdevd/'
license=(ISC)
groups=(base)
depends=()
makedepends=(skalibs-dev)
options=()
changelog=ChangeLog
source=(
    "http://skarnet.org/software/mdevd/mdevd-${pkgver}.tar.gz"
    mdev.conf
)

sha256sums=(
    ffd3b223b4cf0e51253b4a8f09cb88d70bf22693228ab0818af174a3f099dcd2
    a3cd52e38bdfac9e27f0c82cf63f518c1136518dd978cfa4fe6ce104be56c1f8
)

backup=(etc/mdev.conf)

build() {
    cd_unpacked_src
    ./configure \
      --prefix=/ \
      --bindir=/sbin \
      --enable-static-libc
    make
}

package() {
    pkgfiles=(
        sbin
    )
    std_package
    install -d "${pkgdir}/etc"
    install -m0644 "${srcdir}/mdev.conf" "${pkgdir}/etc/mdev.conf"
}
